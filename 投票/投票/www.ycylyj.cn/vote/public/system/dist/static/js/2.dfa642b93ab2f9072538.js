webpackJsonp([2],{"4Aof":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("Xxa5"),a=i.n(n),o=i("exGp"),s=i.n(o),c=i("Fd2+"),r=i("rASa"),l={name:"works",data:function(){return{detail_id:null,active_info:[],searchVal:"",page:1,banners:null,listData:[],imgLink:"",music_url:"../static/music.mp3",music_play:!0,count_down:"",showPopup:!1,qrcode:"",url:""+window.location.href,posterImg:"",painting:{}}},mounted:function(){this.getInfo(),this.getList()},methods:{onClickBuy:function(t){this.$nextTick(function(){this.$router.push({name:"buy",params:{id:this.active_info.id}})}),console.log("Hello")},success:function(t){this.posterImg=t,console.log("海报生成成功")},clickShare:function(){var t=this;if(console.log("点击分享按钮"),c.a.loading({message:"分享海报生成中,请稍等...",forbidClick:!0}),""!==t.posterImg)return c.a.clear(),t.showPopup=!0,!1;t.createPoster(),setTimeout(function(){c.a.clear(),t.showPopup=!0},1e3)},createPoster:function(){var t=this;console.log("生成海报"),t.$nextTick(function(){t.painting={width:320,height:500,views:[{type:"rect",top:0,left:0,background:"#f4f5f7",width:320,height:500,radius:4},{type:"text",content:""+t.active_info.share_title,fontSize:17,top:20,left:20,width:280,breakWord:!0,MaxLineNumber:2},{type:"image",url:""+t.active_info.share_image,left:20,top:60,width:280,height:400,radius:4},{type:"qrcode",content:""+window.location.href,background:"#fff",color:"#000",top:360,left:200,width:100,height:100},{type:"text",content:"长按识别二维码开始加油吧",fontSize:12,color:"#999999",top:460,left:150}]}})},countDown:function(){var t=this;if(t.active_info.length<=0)return!1;var e=t.active_info,i=new Date,n=1e3*parseInt(e.start_time),a=1e3*parseInt(e.end_time);return i.getTime()>a?(t.count_down="活动已结束",!1):i.getTime()<n?(t.count_down="活动尚未开始",!1):void setInterval(function(){var e=new Date(a),i=e.getTimezoneOffset();e.setTime(e.getTime()+60*i*1e3+288e5);var n=e.getTime()-(new Date).getTime(),o=Math.floor(n/864e5),s=n%864e5,c=Math.floor(s/36e5),r=s%36e5,l=Math.floor(r/6e4),u=r%6e4,v=Math.round(u/1e3);t.count_down="距离活动结束还有 "+o+"天"+c+"小时"+l+"分钟"+v+"秒"},1e3)},onClickComplain:function(){this.$router.push({name:"complain"})},onClickPlay:function(){var t=document.getElementsByTagName("Audio")[0];t.paused?(t.play(),this.music_play=!0):(t.pause(),this.music_play=!1)},onSearch:function(){this.getList()},getInfo:function(){var t=this;return s()(a.a.mark(function e(){var i;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=t,t.$axios.get("/api/event/get_info/id/"+t.$route.params.pid).then(function(t){1===t.code&&(i.$store.commit("set_db",t.data),i.active_info=t.data,i.banners=t.data.banner,i.$store.commit("set_notice_text",t.data.notice_text),i.countDown(),""!==t.data.music_file&&(i.music_url=t.data.music_file),i.imgLink=i.banners[0].image,document.title=i.active_info.name,r.a.share(i.active_info.share_title,i.active_info.share_desc,i.active_info.share_image))}).catch(function(t){console.log(t)});case 2:case"end":return e.stop()}},e,t)}))()},getList:function(){var t=this;this.$axios.get("/api/event/get_works_list",{params:{id:t.$route.params.pid,name:t.searchVal,page:t.page}}).then(function(e){if(1===e.code){if(e.data.length<=0)return t.$toast("暂无更多作品"),--t.page,!1;t.page>=2?t.listData=t.listData.concat(e.data):t.listData=e.data}else t.$toast(e.msg),--t.page}).catch(function(t){console.log(t)})},onVote_btn:function(t){this.$router.push({name:"detail",params:{id:t}})},loadingPage:function(){this.page++,this.getList()}}},u={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{"font-size":"14px"}},[n("van-notice-bar",{attrs:{text:t.$store.state.notice_text,"left-icon":"volume-o"}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],on:{click:t.onClickBuy}},[n("img",{staticStyle:{width:"100%"},attrs:{src:i("cbbK"),alt:""}})]),t._v(" "),n("van-row",[n("van-swipe",{attrs:{autoplay:3e3,"indicator-color":"#ff5959"}},t._l(t.banners,function(t,e){return n("van-swipe-item",{key:e},[n("img",{attrs:{src:t.image,width:"100%"}})])}),1)],1),t._v(" "),n("van-row",[n("van-cell-group",[n("van-cell",{attrs:{title:t.active_info.name?t.active_info.name:"活动"}})],1),t._v(" "),n("van-row",{staticStyle:{padding:"18px 0","text-align":"center","background-color":"#eff1f7"},attrs:{type:"flex",justify:"center"}},[n("van-col",{attrs:{span:"8"}},[n("van-row",[t._v("已报名")]),t._v(" "),n("van-row",{domProps:{textContent:t._s(t.active_info.join_num)}})],1),t._v(" "),n("van-col",{attrs:{span:"8"}},[n("van-row",[t._v("累计集赞")]),t._v(" "),n("van-row",{domProps:{textContent:t._s(t.active_info.vote_num)}})],1),t._v(" "),n("van-col",{attrs:{span:"8"}},[n("van-row",[t._v("热度")]),t._v(" "),n("van-row",{domProps:{textContent:t._s(t.active_info.look_num)}})],1)],1),t._v(" "),n("div",{staticClass:"ranking",staticStyle:{color:"#999"},domProps:{textContent:t._s(t.count_down)}}),t._v(" "),n("div",{staticClass:"ranking",on:{click:function(e){return t.$router.push({name:"ranking",params:{pid:t.$store.state.pid}})}}},[t._v("集赞榜")])],1),t._v(" "),n("van-row",[n("van-search",{attrs:{placeholder:"请输入编号或名称","show-action":"",shape:"round"},on:{search:t.onSearch},model:{value:t.searchVal,callback:function(e){t.searchVal=e},expression:"searchVal"}},[n("div",{attrs:{slot:"action"},on:{click:function(e){return t.onSearch()}},slot:"action"},[t._v("搜索")])])],1),t._v(" "),t.listData.length>0?n("div",[n("div",{staticClass:"list-box"},[n("ul",{staticClass:"list-box1"},t._l(t.listData,function(e,i){return n("div",{key:e.id,on:{click:function(i){return t.onVote_btn(e.id)}}},[i%2!=1?n("div",{staticClass:"list-item"},[n("div",{staticClass:"list-item-vote_num"},[n("span",{domProps:{textContent:t._s(e.sort_id)}}),t._v("号 \n              "),n("span",{domProps:{textContent:t._s(e.vote_num)}}),t._v("赞\n            ")]),t._v(" "),n("img",{attrs:{src:e.images,width:"100%"}}),t._v(" "),n("div",{staticClass:"list-item-footer"},[n("div",{staticClass:"list-item-footer-title"},[n("span",{domProps:{textContent:t._s(e.user_name?e.user_name.substring(0,3):"参与者")}}),t._v(" "),e.title?n("span",[t._v("《"+t._s(e.title)+"》")]):t._e()]),t._v(" "),n("div",{staticClass:"list-item-footer-btn",on:{click:function(i){return t.onVote_btn(e.id)}}},[t._v("集赞")])])]):t._e()])}),0),t._v(" "),n("ul",{staticClass:"list-box2"},t._l(t.listData,function(e,i){return n("div",{key:e.id,on:{click:function(i){return t.onVote_btn(e.id)}}},[i%2!=0?n("div",{staticClass:"list-item"},[n("div",{staticClass:"list-item-vote_num"},[n("span",{domProps:{textContent:t._s(e.sort_id)}}),t._v("号 \n              "),n("span",{domProps:{textContent:t._s(e.vote_num)}}),t._v("赞\n            ")]),t._v(" "),n("img",{attrs:{src:e.images,width:"100%"}}),t._v(" "),n("div",{staticClass:"list-item-footer"},[n("div",{staticClass:"list-item-footer-title"},[n("span",{domProps:{textContent:t._s(e.user_name?e.user_name.substring(0,3):"参与者")}}),t._v(" "),e.title?n("span",[t._v("《"+t._s(e.title)+"》")]):t._e()]),t._v(" "),n("div",{staticClass:"list-item-footer-btn",on:{click:function(i){return t.onVote_btn(e.id)}}},[t._v("集赞")])])]):t._e()])}),0)]),t._v(" "),n("div",{staticClass:"loading",on:{click:t.loadingPage}},[t._v("加载更多")])]):n("div",{staticClass:"loading"},[t._v("暂无作品展示")]),t._v(" "),n("van-row",[n("van-panel",{attrs:{title:"活动介绍"}})],1),t._v(" "),n("div",{staticStyle:{padding:"3px 14px","line-height":"28px",color:"#666"},domProps:{innerHTML:t._s(t.active_info.desc)}}),t._v(" "),n("div",{staticClass:"music-box"},[n("div",{staticClass:"music-tools",on:{click:function(e){return t.onClickPlay()}}},[n("audio",{attrs:{src:t.music_url,autoplay:""}}),t._v(" "),n("img",{class:{rotate_music:t.music_play},staticStyle:{width:"100%"},attrs:{src:i("IiyH"),alt:""}})])]),t._v(" "),n("div",{staticClass:"complain-box",on:{click:function(e){return t.onClickComplain()}}},[t._v("投诉")]),t._v(" "),n("div",{staticClass:"share_btn",on:{click:function(e){return t.clickShare()}}},[n("van-icon",{attrs:{name:"share",size:"32px"}})],1),t._v(" "),n("van-popup",{style:{width:"320px",height:"520px",background:"none"},attrs:{round:""},model:{value:t.showPopup,callback:function(e){t.showPopup=e},expression:"showPopup"}},[n("img",{attrs:{src:t.posterImg,alt:""}})]),t._v(" "),n("vue-canvas-poster",{attrs:{painting:t.painting},on:{success:t.success}})],1)},staticRenderFns:[]};var v=i("VU/8")(l,u,!1,function(t){i("K7Sr")},"data-v-dfb0cc78",null);e.default=v.exports},IiyH:function(t,e){t.exports="data:image/png;base64,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"},K7Sr:function(t,e){},cbbK:function(t,e,i){t.exports=i.p+"static/img/buy_1.6e6fba1.jpg"}});
//# sourceMappingURL=2.dfa642b93ab2f9072538.js.map